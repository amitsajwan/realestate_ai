<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PropertyAI - Agent Onboarding</title>
    
    <!-- External CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- âœ… UNIFIED: Single CSS file for all styles -->
    {% include 'components/propertyai_styles_unified.html' %}
</head>
<body>
    <div class="onboarding-container">
        <div class="text-center mb-4">
            <h1>ðŸš€ Welcome to PropertyAI</h1>
            <p class="text-muted">Complete your agent profile to get started</p>
        </div>
        
        <form method="POST" action="/agent/onboard" class="glass-card">
            <!-- Step 1: Basic Information -->
            <div class="onboarding-step" id="step1">
                <h3><i class="fas fa-user me-2"></i>Step 1: Basic Information</h3>
                
                <div class="form-group">
                    <label for="name" class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="name" name="name" required>
                </div>
                
                <div class="form-group">
                    <label for="email" class="form-label">Email Address</label>
                    <input type="email" class="form-control" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="whatsapp" class="form-label">WhatsApp Number</label>
                    <input type="tel" class="form-control" name="whatsapp" required>
                </div>
                
                <div class="d-flex justify-content-end">
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 2: Branding -->
            <div class="onboarding-step" id="step2" style="display: none;">
                <h3><i class="fas fa-palette me-2"></i>Step 2: Branding</h3>
                
                <div class="form-group">
                    <label for="tagline" class="form-label">Business Tagline (Optional)</label>
                    <input type="text" class="form-control" id="tagline" name="tagline" placeholder="e.g., Your Trusted Real Estate Partner">
                </div>
                
                <div class="form-group">
                    <label for="about" class="form-label">About Your Business (Optional)</label>
                    <textarea class="form-control" id="about" name="about" rows="4" placeholder="Tell us about your real estate business, experience, and what makes you unique..."></textarea>
                </div>
                
                <div class="form-group">
                    <button type="button" class="btn btn-secondary" id="suggestBranding">
                        <i class="fas fa-magic me-2"></i>AI Branding Suggestions
                    </button>
                </div>
                
                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-primary" onclick="prevStep()">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 3: Profile -->
            <div class="onboarding-step" id="step3" style="display: none;">
                <h3><i class="fas fa-camera me-2"></i>Step 3: Profile</h3>
                
                <div class="form-group">
                    <label for="profilePhoto" class="form-label">Profile Photo URL (Optional)</label>
                    <input type="url" class="form-control" name="profile_photo_url" placeholder="https://example.com/photo.jpg">
                </div>
                
                <div class="form-group">
                    <label class="form-label">AI Content Tone</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="aiTone" id="toneHelpful" value="helpful" checked>
                        <label class="form-check-label" for="toneHelpful">Helpful & Informative</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="aiTone" id="tonePersuasive" value="persuasive">
                        <label class="form-check-label" for="tonePersuasive">Persuasive & Sales-focused</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="aiTone" id="toneConsultative" value="consultative">
                        <label class="form-check-label" for="toneConsultative">Consultative & Advisory</label>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-primary" onclick="prevStep()">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 4: Preferences -->
            <div class="onboarding-step" id="step4" style="display: none;">
                <h3><i class="fas fa-cog me-2"></i>Step 4: Preferences</h3>
                
                <div class="form-group">
                    <label class="form-label">Automation Preferences</label>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="autoPosting">
                        <label class="form-check-label" for="autoPosting">Enable automatic property posting</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Content Preferences</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="propertyDescriptions" checked>
                        <label class="form-check-label" for="propertyDescriptions">AI-generated property descriptions</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="socialPosts" checked>
                        <label class="form-check-label" for="socialPosts">AI social media posts</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="marketInsights" checked>
                        <label class="form-check-label" for="marketInsights">Market insights and trends</label>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-primary" onclick="prevStep()">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 5: Terms & Conditions -->
            <div class="onboarding-step" id="step5" style="display: none;">
                <h3><i class="fas fa-file-contract me-2"></i>Step 5: Terms & Conditions</h3>
                
                <div class="form-group">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="termsAccepted" required>
                        <label class="form-check-label" for="termsAccepted">
                            I agree to the <a href="#" class="text-primary">Terms of Service</a> and <a href="#" class="text-primary">Privacy Policy</a>
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="gdprAccepted">
                        <label class="form-check-label" for="gdprAccepted">
                            I consent to the processing of my personal data in accordance with GDPR
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="marketingAccepted">
                        <label class="form-check-label" for="marketingAccepted">
                            I agree to receive marketing communications and updates about PropertyAI
                        </label>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-primary" onclick="prevStep()">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 6: Notifications -->
            <div class="onboarding-step" id="step6" style="display: none;">
                <h3><i class="fas fa-bell me-2"></i>Step 6: Notification Preferences</h3>
                
                <div class="form-group">
                    <label class="form-label">How would you like to be notified?</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="emailNotifications" checked>
                        <label class="form-check-label" for="emailNotifications">Email notifications</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="smsNotifications">
                        <label class="form-check-label" for="smsNotifications">SMS notifications</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="pushNotifications" checked>
                        <label class="form-check-label" for="pushNotifications">Push notifications</label>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-primary" onclick="prevStep()">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 7: Final Review -->
            <div class="onboarding-step" id="step7" style="display: none;">
                <h3><i class="fas fa-check-circle me-2"></i>Step 7: Review & Complete</h3>
                
                <div class="alert alert-info">
                    <h5><i class="fas fa-info-circle me-2"></i>Almost Done!</h5>
                    <p class="mb-0">Please review your information before completing the setup. You can go back to any step to make changes.</p>
                </div>
                
                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-primary" onclick="prevStep()">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-rocket me-2"></i> Complete Setup
                    </button>
                </div>
            </div>
        </form>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 7;
        
        function showStep(stepNumber) {
            // Hide all steps
            document.querySelectorAll('.onboarding-step').forEach(step => {
                step.style.display = 'none';
            });
            
            // Show current step
            document.getElementById(`step${stepNumber}`).style.display = 'block';
        }
        
        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
            }
        }
        
        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }
        
        // AI Branding Suggestions
        document.getElementById('suggestBranding') && document.getElementById('suggestBranding').addEventListener('click', async function () {
            var nameInput = document.getElementById('name');
            var name = nameInput && nameInput.value || '';
            if (!name) {
                alert('Please enter your name first to get AI suggestions!');
                return;
            }
            
            try {
                var form = new FormData();
                form.append('name', name);
                var resp = await fetch('/agent/branding-suggest', { method: 'POST', body: form });
                if (resp.ok) {
                    var data = await resp.json();
                    var tagInput = document.getElementById('tagline');
                    var aboutInput = document.getElementById('about');
                    if (tagInput) tagInput.value = data.tagline || '';
                    if (aboutInput) aboutInput.value = data.about || '';
                    
                    // Show success message
                    const button = this;
                    const originalText = button.innerHTML;
                    button.innerHTML = '<i class="fas fa-check me-2"></i>Suggestions Applied!';
                    button.classList.remove('btn-secondary');
                    button.classList.add('btn-success');
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.classList.remove('btn-success');
                        button.classList.add('btn-secondary');
                    }, 2000);
                }
            } catch (error) {
                console.error('Error getting branding suggestions:', error);
                alert('Failed to get AI suggestions. Please try again.');
            }
        });
        
        // Initialize first step
        showStep(1);
    </script>
</body>
</html>
