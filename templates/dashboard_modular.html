<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PropertyAI - Next-Gen AI Real Estate Dashboard</title>
    
    <!-- External CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- EXISTING Dashboard Styles (Keep all current styles) -->
    {% include 'components/dashboard_styles.html' %}
    
    <!-- NEW Next-Gen Styles (Add new styles) -->
    {% include 'components/dashboard_styles_nextgen.html' %}
    
    <!-- ‚úÖ FIXED: Essential Next-Gen styles to ensure proper layout -->
    <style>
        /* Essential Next-Gen styles */
        body.nextgen-enabled {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            color: #ffffff;
            min-height: 100vh;
            padding-bottom: 100px; /* Space for bottom nav */
        }
        
        /* Ensure welcome section is visible */
        #welcome-section {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Ensure bottom navigation is at bottom */
        .nextgen-bottom-nav {
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 1000 !important;
            background: rgba(15, 15, 35, 0.95) !important;
            backdrop-filter: blur(20px) !important;
            border-top: 1px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        /* Ensure FAB is above bottom nav */
        .nextgen-fab {
            position: fixed !important;
            bottom: 100px !important;
            right: 1rem !important;
            z-index: 999 !important;
            background: linear-gradient(135deg, #8b5cf6, #ec4899) !important;
            border: none !important;
            border-radius: 50% !important;
            color: white !important;
            width: 60px !important;
            height: 60px !important;
            font-size: 1.5rem !important;
            cursor: pointer !important;
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4) !important;
        }
        
        /* Ensure stats are visible */
        #nextgenStatsRow {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .nextgen-stat {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .nextgen-stat-card {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            background: rgba(255, 255, 255, 0.1) !important;
            backdrop-filter: blur(20px) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 12px !important;
            padding: 1.5rem !important;
            text-align: center !important;
        }
        
        /* Override any conflicting styles */
        .dashboard-section {
            color: #ffffff !important;
        }
        
        .text-dark {
            color: #ffffff !important;
        }
        
        .text-muted {
            color: #a1a1aa !important;
        }
    </style>
</head>
<body class="nextgen-enabled"> <!-- ‚úÖ Next-Gen mode always enabled -->
    <!-- EXISTING Dashboard Header (Keep unchanged) -->
    {% include 'components/dashboard_header.html' %}
    
    <!-- EXISTING Main Dashboard Content (Keep unchanged) -->
    {% include 'components/dashboard_main.html' %}
    
    <!-- ‚úÖ Next-Gen Bottom Navigation (Always visible) -->
    <nav class="nextgen-bottom-nav" id="nextgenBottomNav">
        <a href="#" class="nextgen-nav-item active" onclick="showSection('welcome')">
            <div><i class="fas fa-home"></i></div>
            <div style="font-size: 0.75rem;">Home</div>
        </a>
        <a href="#" class="nextgen-nav-item" onclick="showSection('properties')">
            <div><i class="fas fa-building"></i></div>
            <div style="font-size: 0.75rem;">Properties</div>
        </a>
        <a href="#" class="nextgen-nav-item" onclick="showSection('ai-content')">
            <div><i class="fas fa-robot"></i></div>
            <div style="font-size: 0.75rem;">AI Tools</div>
        </a>
        <a href="#" class="nextgen-nav-item" onclick="showSection('facebook')">
            <div><i class="fas fa-share-alt"></i></div>
            <div style="font-size: 0.75rem;">Social</div>
        </a>
        <a href="#" class="nextgen-nav-item" onclick="showSection('onboarding')">
            <div><i class="fas fa-user"></i></div>
            <div style="font-size: 0.75rem;">Profile</div>
        </a>
    </nav>

    <!-- ‚úÖ Next-Gen FAB (Always visible) -->
    <button class="nextgen-fab" id="nextgenFAB" onclick="showSection('properties')">
        <i class="fas fa-plus"></i>
    </button>

    <!-- ‚úÖ Next-Gen Background (Always visible) -->
    <div class="nextgen-bg" id="nextgenBg"></div>
    
    <!-- EXISTING External JavaScript (Keep unchanged) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- EXISTING Dashboard Scripts (Keep unchanged) -->
    {% include 'components/dashboard_scripts.html' %}
    
    <!-- ‚úÖ SIMPLIFIED: Next-Gen initialization script -->
    <script>
        // ‚úÖ SIMPLIFIED: Always use Next-Gen mode
        const nextgenMode = true;
        
        // ‚úÖ ADDED: Debug logging
        console.log('üöÄ Next-Gen script loaded');
        console.log('üîç Body class:', document.body.className);
        console.log('üîç Welcome section exists:', !!document.getElementById('welcome-section'));
        console.log('üîç Bottom nav exists:', !!document.getElementById('nextgenBottomNav'));
        console.log('üîç FAB exists:', !!document.getElementById('nextgenFAB'));
        
        // ‚úÖ SIMPLIFIED: Enhanced stats animation
        function animateNextGenStats() {
            const stats = document.querySelectorAll('.nextgen-stat-number');
            stats.forEach((stat, index) => {
                const target = parseInt(stat.textContent) || Math.floor(Math.random() * 100) + 1;
                let current = 0;
                const increment = target / 30;
                
                const timer = setInterval(() => {
                    current += increment;
                    stat.textContent = Math.floor(current);
                    
                    if (current >= target) {
                        stat.textContent = target;
                        clearInterval(timer);
                    }
                }, 50);
            });
        }
        
        // ‚úÖ SIMPLIFIED: Override showSection for nextgen compatibility
        const originalShowSection = window.showSection;
        window.showSection = function(sectionName) {
            console.log(`üéØ Next-Gen showSection override called with: ${sectionName}`);
            
            if (originalShowSection) {
                originalShowSection(sectionName);
            }
            
            // Update nextgen navigation
            document.querySelectorAll('.nextgen-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeNavItem = document.querySelector(`.nextgen-nav-item[onclick*="${sectionName}"]`);
            if (activeNavItem) {
                activeNavItem.classList.add('active');
                console.log(`‚úÖ Navigation updated for ${sectionName}`);
            }
        };
        
        // ‚úÖ SIMPLIFIED: Single initialization function
        function initializeNextGen() {
            console.log('üöÄ Initializing Next-Gen mode...');
            
            // Ensure body has nextgen-enabled class
            document.body.classList.add('nextgen-enabled');
            console.log('‚úÖ Body class set:', document.body.className);
            
            // Show welcome section by default
            const welcomeSection = document.getElementById('welcome-section');
            if (welcomeSection) {
                welcomeSection.style.display = 'block';
                welcomeSection.style.visibility = 'visible';
                welcomeSection.style.opacity = '1';
                console.log('‚úÖ Welcome section displayed');
            } else {
                console.error('‚ùå Welcome section not found!');
            }
            
            // Ensure stats are visible
            const statsRow = document.getElementById('nextgenStatsRow');
            if (statsRow) {
                statsRow.style.display = 'block';
                statsRow.style.visibility = 'visible';
                console.log('‚úÖ Stats row displayed');
            } else {
                console.error('‚ùå Stats row not found!');
            }
            
            // Mark welcome as active in navigation
            const welcomeNavItem = document.querySelector('.nextgen-nav-item[onclick*="welcome"]');
            if (welcomeNavItem) {
                document.querySelectorAll('.nextgen-nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                welcomeNavItem.classList.add('active');
                console.log('‚úÖ Welcome navigation active');
            } else {
                console.error('‚ùå Welcome navigation item not found!');
            }
            
            // ‚úÖ ADDED: Initialize dashboard scripts after Next-Gen setup
            if (typeof initializeDashboardFromScripts === 'function') {
                console.log('üîÑ Calling dashboard scripts initialization...');
                initializeDashboardFromScripts();
            } else {
                console.log('‚ö†Ô∏è Dashboard scripts not loaded yet, waiting...');
                setTimeout(() => {
                    if (typeof initializeDashboardFromScripts === 'function') {
                        initializeDashboardFromScripts();
                    } else {
                        console.error('‚ùå Dashboard scripts still not loaded after timeout');
                    }
                }, 100);
            }
            
            console.log('‚úÖ Next-Gen mode initialized successfully');
        }
        
        // ‚úÖ SIMPLIFIED: Single DOMContentLoaded listener
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM loaded, initializing Next-Gen...');
            console.log('üîç DOM ready, body class:', document.body.className);
            initializeNextGen();
        });
        
        // ‚úÖ ADDED: Fallback initialization if DOMContentLoaded already fired
        if (document.readyState === 'loading') {
            console.log('üîÑ DOM still loading, waiting for DOMContentLoaded...');
        } else {
            console.log('üöÄ DOM already loaded, initializing immediately...');
            initializeNextGen();
        }
    </script>
</body>
</html>